{
    "version": "118.0.2",
    "description": "Firefox. Popular open source web browser.",
    "homepage": "https://www.mozilla.org/firefox/",
    "license": "MPL-2.0",
    "changelog": "https://www.mozilla.org/en-US/firefox/118.0.2/releasenotes/",
    "architecture": {
        "64bit": {
            "url": "https://archive.mozilla.org/pub/firefox/releases/118.0.2/win64/en-US/Firefox%20Setup%20118.0.2.exe#/dl.7z",
            "hash": "sha512:949f024d1eb4d8afbce62d82686e1917ea5d885e19688e38f4139dc02159690a18b0cb957f7fa27c613a3d8013d70223ace988aa189e63ee5fc247aa4f724b4b"
        },
        "32bit": {
            "url": "https://archive.mozilla.org/pub/firefox/releases/118.0.2/win32/en-US/Firefox%20Setup%20118.0.2.exe#/dl.7z",
            "hash": "sha512:83edd443637ca760775affd5f5452bc0b0b5aa8c5c35304cf94eb2d1e6af2687357c303ba2b2d96066e3edbc2375afb429dbd0c7d36c5b98c86e6fe500dd8298"
        }
    },
    "extract_dir": "core",
    "bin": "firefox.exe",
    "shortcuts": [
        [
            "firefox.exe",
            "Firefox"
        ]
    ],
    "post_install": [
        "if (Test-Path \"$persist_dir\\.use_persist_profile\") {",
        "   $shortcutPath = Join-Path -Path (Convert-Path([System.IO.Path]::Combine([Environment]::GetFolderPath($global ? 'CommonStartMenu':'StartMenu'), 'Programs', 'Scoop Apps'))) -ChildPath 'Firefox.lnk'",
        "   $defaultShortcutPath = Join-Path -Path (Convert-Path([System.IO.Path]::Combine([Environment]::GetFolderPath($global ? 'CommonStartMenu':'StartMenu'), 'Programs', 'Scoop Apps'))) -ChildPath 'Firefox (Default).lnk'",
        "   if (-not (Test-Path \"$persist_dir\\.no_default_shortcut\")) {",
        "       Copy-Item -Path $shortcutPath -Destination $defaultShortcutPath -Force -ErrorAction SilentlyContinue",
        "   }",
        "   $shortcut = (New-Object -ComObject WScript.Shell).CreateShortcut($shortcutPath)",
        "   if ((Get-Content \"$persist_dir\\.use_persist_profile\").Length -eq 0) {",
        "       $shortcut.Arguments = '-P \"default-release\"'",
        "   } else {",
        "       $persistProfile = (Get-Content \"$persist_dir\\.use_persist_profile\" -First 1) -replace \"`n\", \"\" -replace \"`r\", \"\"",
        "       $shortcut.Arguments = \"-P `\"$persistProfile`\"\"",
        "   }",
        "   $shortcut.Save()",
        "}"
    ],
    "post_uninstall": [
        "$defaultShortcutPath = Join-Path -Path (Convert-Path([System.IO.Path]::Combine([Environment]::GetFolderPath($global ? 'CommonStartMenu':'StartMenu'), 'Programs', 'Scoop Apps'))) -ChildPath 'Firefox (Default).lnk'",
        "if (Test-Path $defaultShortcutPath) {",
        "   Remove-Item -Path $defaultShortcutPath -Force -ErrorAction SilentlyContinue",
        "}"
    ],
    "checkver": {
        "url": "https://www.mozilla.org/en-US/firefox/notes/",
        "regex": "<div class=\"c-release-version\">([\\d.]+)</div>"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://archive.mozilla.org/pub/firefox/releases/$version/win64/en-US/Firefox%20Setup%20$version.exe#/dl.7z",
                "hash": {
                    "url": "https://archive.mozilla.org/pub/firefox/releases/$version/SHA512SUMS",
                    "regex": "$sha512\\s+win64/en-US/$basename"
                }
            },
            "32bit": {
                "url": "https://archive.mozilla.org/pub/firefox/releases/$version/win32/en-US/Firefox%20Setup%20$version.exe#/dl.7z",
                "hash": {
                    "url": "https://archive.mozilla.org/pub/firefox/releases/$version/SHA512SUMS",
                    "regex": "$sha512\\s+win32/en-US/$basename"
                }
            }
        },
        "changelog": "https://www.mozilla.org/en-US/firefox/$version/releasenotes/"
    },
    "notes": [
        "User profiles are located in %USERPROFILE%\\AppData\\Local\\Mozilla\\Firefox\\Profiles",
        "They will not be automatically removed during uninstallation even with -p flag. Delete them manually if need to.",
        "A new default profile is always created when a new version is installed. Old profiles can be found and managed in about:profiles.",
        "To make the start menu shortcut always use a profile that persists across updates, create a file named '.use_persist_profile' in the persist directory.",
        "Then the shortcut will use the profile defined in the first line of it, and another shortcut named 'Firefox (Default)' will be created to use the default profile set in about:profiles.",
        "You can further create a file named '.no_default_shortcut' in the persist directory to prevent the creation of the 'Firefox (Default)' shortcut."
    ]
}
