{
    "version": "nightly",
    "homepage": "https://www.icloud.com/",
    "description": "The official Windows 10/11 client for iCloud.",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.apple.com/legal/internet-services/terms/site.html"
    },
    "url": "https://updates.cdn-apple.com/2020/windows/001-39935-20200911-1A70AA56-F448-11EA-8CC0-99D41950005E/iCloudSetup.exe",
    "pre_install": [
        "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "if ((Get-WindowsCapability -Online -Name 'Media.WindowsMediaPlayer*').State -ne 'Installed') {",
        "    Write-Host \"Please install `e[4m`e[31;1mWindows Media Player`e[0m, as $($PSStyle.Background.FromRgb(0x0061b6))`e[37miCloud`e[0m requires it to function!\"",
        "    Write-Host \"You can install `e[4m`e[31;1mWindows Media Player`e[0m by using the following command,`n\"",
        "    Write-Host \"`t`e[33mGet-WindowsCapability`e[0m `e[90m-Online`e[0m | `e[33mWhere-Object`e[0m `e[90m-Property`e[0m `e[36m'Name'`e[0m `e[90m-Like`e[0m `e[36m'Media.WindowsMediaPlayer*'`e[0m | `e[33mAdd-WindowsCapability`e[0m `e[90m-Online`e[0m\"",
        "    Write-Host \"You can remove `e[4m`e[31;1mWindows Media Player`e[0m by using the following command,`n\"",
        "    Write-Host \"`t`e[33mGet-WindowsCapability`e[0m `e[90m-Online`e[0m | `e[33mWhere-Object`e[0m `e[90m-Property`e[0m `e[36m'Name'`e[0m `e[90m-Like`e[0m `e[36m'Media.WindowsMediaPlayer*'`e[0m | `e[33mRemove-WindowsCapability`e[0m `e[90m-Online`e[0m`n\"",
        "    break",
        "}",
        "Start-Process \"$dir\\iCloudSetup.exe\" -Wait -Verb 'RunAs' -Args @('/qn', '/norestart', 'ACCEPTLICENSE=YES'); Remove-Item \"$dir\\iCloudSetup.exe\""
    ],
    "pre_uninstall": [
        "if ($cmd -eq 'uninstall') {",
        "    if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "    Start-Process 'msiexec' -Wait -Verb 'RunAs' -Args @('/I{11727D12-D910-486F-9B36-B496F4AB334D}', '/qn')",
        "}"
    ]
}
