{
    "version": "0.5.1",
    "description": "An experiment in scalable routing as an encrypted IPv6 overlay network",
    "homepage": "https://yggdrasil-network.github.io",
    "license": "LGPL-3.0-or-later",
    "notes": "Use add-service.ps1 to add Yggdrasil service and remove-service.ps1 to remove Yggdrasil service",
    "architecture": {
        "64bit": {
            "url": "https://github.com/yggdrasil-network/yggdrasil-go/releases/download/v0.5.1/yggdrasil-0.5.1-x64.msi",
            "hash": "411b2ed86c9c3ac65b09bf9054b40b313c992bf34f463f564109fee9189690f3"
        },
        "32bit": {
            "url": "https://github.com/yggdrasil-network/yggdrasil-go/releases/download/v0.5.1/yggdrasil-0.5.1-x86.msi",
            "hash": "ade42d66f986dcb9f70c22a4da0de4591bf9b277ddd1d309a96bf34f47a8c416"
        },
        "arm64": {
            "url": "https://github.com/yggdrasil-network/yggdrasil-go/releases/download/v0.5.1/yggdrasil-0.5.1-arm64.msi",
            "hash": "4a09af4557fbd1c8bcdb7ec1c125da8532297c12671401fa7d6a1971f3aa1acc"
        }
    },
    "extract_dir": "PFiles\\Yggdrasil",
    "pre_install": [
        "$manifest.persist | ForEach-Object {",
        "    if (!(Test-Path \"$persist_dir\\$_\")) { New-Item \"$dir\\$_\" | Out-Null }",
        "}"
    ],
    "post_install": [
        "if (!(Get-Content -Path \"$dir\\yggdrasil.conf\")) {",
        "    yggdrasil.exe -genconf > \"$dir\\yggdrasil.conf\"",
        "}",
        "New-Item \"$dir\\add-service.ps1\" -Value @\"",
        "sc.exe create 'Yggdrasil' binpath= \"$dir\\yggdrasil.exe -useconffile $dir\\yggdrasil.conf -logto $dir\\yggdrasil.log\" start= auto group= NetworkProvider displayname= 'Yggdrasil Service'",
        "sc.exe description 'Yggdrasil' 'Yggdrasil Network router process'",
        "\"@ | Out-Null",
        "New-Item \"$dir\\remove-service.ps1\" -Value \"sc.exe delete 'Yggdrasil'\" | Out-Null"
    ],
    "pre_uninstall": [
        "if (Get-Service -Name 'Yggdrasil' -ErrorAction 'SilentlyContinue') {",
        "   if (!(is_admin)) {error \"$app requires admin rights to $cmd\"; break}",
        "   Stop-Service -Name 'Yggdrasil' -Verbose -ErrorAction 'SilentlyContinue' -Force",
        "   sc.exe delete 'Yggdrasil'",
        "}"
    ],
    "bin": [
        "yggdrasil.exe",
        "yggdrasilctl.exe"
    ],
    "persist": [
        "yggdrasil.conf",
        "yggdrasil.log"
    ],
    "checkver": {
        "github": "https://github.com/yggdrasil-network/yggdrasil-go"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/yggdrasil-network/yggdrasil-go/releases/download/v$version/yggdrasil-$version-x64.msi"
            },
            "32bit": {
                "url": "https://github.com/yggdrasil-network/yggdrasil-go/releases/download/v$version/yggdrasil-$version-x86.msi"
            },
            "arm64": {
                "url": "https://github.com/yggdrasil-network/yggdrasil-go/releases/download/v$version/yggdrasil-$version-arm64.msi"
            }
        }
    }
}
